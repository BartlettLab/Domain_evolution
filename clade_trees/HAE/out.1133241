building database to find priors...
collecting prior sequences from database...
Aligning prior sequences...
building an HMM from the alignment...
collect the top 2 hits for each of the species listed in flowering_plants_species_IDs
Processing species URDJ
Processing species WTKZ
Processing species PZRT
Processing species ROAP
Processing species VZCI
Processing species NWMY
Processing species FZJL
Processing species NPND
Processing species DDEV
Processing species IFCJ
Processing species WKSU
Processing species WAIL
WAIL does not have a peptide database
Processing species FALI
Processing species WPHN
WPHN does not have a peptide database
Processing species MAQO
Processing species BSVG
BSVG does not have a peptide database
Processing species BCGB
Processing species ABSS
Processing species KAYP
Processing species VYLQ
Processing species WIGA
WIGA does not have a peptide database
Processing species KRJP
Processing species YZRI
Processing species PSJT
Processing species DHPO
Processing species XQWC
Processing species WBOD
Processing species OBPL
Processing species PAWA
Processing species QDVW
Processing species MUNP
Processing species XSZI
Processing species OPDF
Processing species CSSK
Processing species WPYJ
Processing species OSHQ
Processing species WZFE
Processing species IWMW
Processing species AALA
Processing species SWOH
Processing species FAKD
Processing species GRRW
Processing species REOF
Processing species OBOJ
Processing species SIIK
Processing species VQFW
Processing species WFBF
Processing species YHFG
Processing species QTJY
Processing species CCID
Processing species LVNW
Processing species NMGG
Processing species AUGV
Processing species UDHA
Processing species XHKT
Processing species YDEH
YDEH does not have a peptide database
Processing species GOQJ
Processing species SMZF
Processing species CCHG
CCHG does not have a peptide database
Processing species BFMT
Processing species UNPT
Processing species NJKC
Processing species RKGT
Processing species TUHA
Processing species ERXG
Processing species RRID
Processing species TMWO
Processing species ZSNV
Processing species ACYX
Processing species GMAM
Processing species QZBA
Processing species IORZ
Processing species MVTX
Processing species FNXH
Processing species MLPX
Processing species JSVC
Processing species STDO
Processing species EPRK
Processing species BMRX
Processing species SUFP
Processing species MIKW
Processing species FPYZ
Processing species KKCW
Processing species ZGQD
ZGQD does not have a peptide database
Processing species XMVD
Processing species GBVZ
Processing species VGHH
Processing species CYVA
Processing species ZUHO
Processing species UPOG
Processing species XMQO
Processing species QUTB
Processing species HAEU
Processing species EHNF
Processing species OKEF
Processing species BJKT
Processing species GJNX
Processing species HZTS
Processing species OPZX
Processing species ZJDK
ZJDK does not have a peptide database
Processing species QNIK
Processing species TNVE
Processing species BERS
Processing species VKOE
Processing species EMIG
EMIG does not have a peptide database
Processing species MEAH
Processing species GBCQ
Processing species JBGU
Processing species XSSD
Processing species WMLW
WMLW does not have a peptide database
Processing species CUTE
Processing species WGET
WGET does not have a peptide database
Processing species BDIW
Processing species AKTA
Processing species EPVF
Processing species MUCT
Processing species PDXY
Processing species LBZM
Processing species SMMC
Processing species KTQI
Processing species ENCD
Processing species WGUG
Processing species VUIT
Processing species LUNL
Processing species OYST
Processing species DEMH
Processing species DBCE
Processing species FVXD
Processing species HSXO
Processing species CTYH
Processing species JLOV
Processing species CPKP
Processing species QAIR
Processing species SKNL
Processing species RXEN
Processing species TJES
Processing species OLES
Processing species SHEZ
Processing species FZQN
Processing species RNBN
Processing species CUVY
Processing species UNSW
Processing species HURS
Processing species BZMI
Processing species QASA
Processing species OFWX
Processing species WQUF
Processing species JAFJ
Processing species DVXD
Processing species EGOS
Processing species WHHY
Processing species MBWM
Processing species HUGU
Processing species GDYP
GDYP does not have a peptide database
Processing species GQAV
Processing species DZRA
Processing species RUUB
Processing species BKQU
BKQU does not have a peptide database
Processing species AZBL
Processing species MRKX
Processing species YNFJ
YNFJ does not have a peptide database
Processing species SFKQ
Processing species CGGO
Processing species WOBD
Processing species FYSJ
Processing species CZJT
Processing species QMUN
Processing species LFQH
Processing species VPCP
Processing species TMMR
Processing species CPLT
Processing species BYNZ
Processing species UQCB
Processing species TRLB
Processing species IWIS
Processing species GCYL
Processing species KDCH
Processing species LKKX
Processing species GIWN
Processing species CVDF
Processing species HTDC
Processing species STKY
Processing species XKPS
Processing species VGVI
VGVI does not have a peptide database
Processing species RSPO
Processing species BSEY
Processing species XGFU
Processing species QKMG
Processing species YHXT
Processing species DMKC
Processing species HQRJ
Processing species OMDH
Processing species FWBF
Processing species LMVB
Processing species NUZN
Processing species ZJUL
Processing species KWGC
Processing species DRIL
Processing species FYTP
Processing species SYHW
Processing species IUSR
Processing species TOKV
Processing species UWFU
Processing species HTIP
Processing species FCBJ
Processing species ERIA
ERIA does not have a peptide database
Processing species CIAC
Processing species UHBY
Processing species DAYQ
Processing species OOVX
Processing species CKKR
Processing species SLOI
Processing species YKFU
YKFU does not have a peptide database
Processing species CTSS
Processing species BGZG
Processing species SZPD
Processing species BBBA
Processing species VYGG
Processing species PTLU
Processing species VKGP
Processing species YGCX
YGCX does not have a peptide database
Processing species HDWF
HDWF does not have a peptide database
Processing species FONV
Processing species AJJE
Processing species NIJU
Processing species RJNQ
Processing species JROW
Processing species QEBC
Processing species YMUO
Processing species VUGF
Processing species SWGX
Processing species WWQZ
Processing species FGDU
Processing species NEBM
Processing species AYMT
Processing species JLLY
Processing species FEDW
Processing species DSVQ
Processing species EXGW
Processing species FDBS
Processing species MLUJ
Processing species DWAP
Processing species REZJ
Processing species MJHP
Processing species GZUR
Processing species EBPG
Processing species HOOU
Processing species SEMK
Processing species ICUS
Processing species FXJC
Processing species NQWS
Processing species TGOP
Processing species GVCB
Processing species HKMQ
Processing species KBRW
Processing species JKNQ
Processing species ECSL
Processing species LACT
Processing species LHDP
LHDP does not have a peptide database
Processing species IIFB
Processing species JYOB
Processing species IDAU
Processing species XSNO
Processing species YHLF
Processing species DZLN
Processing species CJGZ
Processing species HPNZ
Processing species DIBI
DIBI does not have a peptide database
Processing species AQXA
Processing species QBRF
Processing species ONZG
Processing species EWHG
Processing species TAHF
Processing species WPUV
Processing species CHTD
Processing species EQYT
Processing species JMJV
Processing species YIVZ
Processing species KFAL
Processing species SJAN
Processing species RLZU
RLZU does not have a peptide database
Processing species UASK
Processing species XZPP
Processing species XZAQ
Processing species GBGW
Processing species AJBK
Processing species ROLB
Processing species UDUT
Processing species KVAY
Processing species ZHMB
Processing species IHCQ
Processing species MFEA
Processing species OCTM
Processing species AXAF
Processing species NNGU
Processing species SUAK
Processing species RKLL
Processing species RMWJ
Processing species PEZP
Processing species RKFX
Processing species GEHT
Processing species QZXQ
QZXQ does not have a peptide database
Processing species KZED
KZED does not have a peptide database
Processing species XOOE
Processing species NXOH
Processing species SLYR
Processing species KNMB
Processing species CMFF
Processing species TTRG
Processing species TVSH
Processing species HJMP
Processing species JTQQ
JTQQ does not have a peptide database
Processing species VLNB
Processing species ZUQW
ZUQW does not have a peptide database
Processing species OAQS
Processing species LXGM
Processing species RIDD
Processing species PFSA
Processing species TJMB
Processing species AKRH
Processing species FPLR
Processing species LQUX
Processing species JETM
Processing species ZSSR
Processing species ATQZ
Processing species MGBF
Processing species MYMP
Processing species VHZV
Processing species ZCDJ
Processing species OHAE
Processing species OQHZ
Processing species CWZU
Processing species LWDA
Processing species LNER
Processing species SVVG
Processing species HENI
Processing species UZWG
Processing species NHUA
Processing species DXQW
Processing species VWIP
Processing species INSP
Processing species TJLC
Processing species NFXV
Processing species ZBVT
Processing species HBUQ
Processing species FWCQ
Processing species OSIP
Processing species PAZJ
Processing species XNLP
Processing species VVPY
VVPY does not have a peptide database
Processing species PXYR
Processing species VPDX
Processing species LSLA
Processing species BNDE
Processing species MYVH
Processing species MJAV
Processing species OZJZ
Processing species OGSY
Processing species HNCF
Processing species BHYC
Processing species AEPI
Processing species AXPJ
Processing species KCPT
Processing species XWMS
Processing species LFII
Processing species OODC
Processing species VXOD
Processing species TXMP
Processing species XPBC
Processing species COAQ
Processing species TVCU
Processing species CKDK
Processing species EZZT
EZZT does not have a peptide database
Processing species SIZE
Processing species YGAT
Processing species VNMY
Processing species RVGH
Processing species ZTLR
ZTLR does not have a peptide database
Processing species RPPC
Processing species INQX
Processing species IEPQ
Processing species GLVK
Processing species LFOG
Processing species TDTF
Processing species KKDQ
Processing species RZTJ
RZTJ does not have a peptide database
Processing species LPGY
Processing species NJLF
Processing species YZVJ
Processing species TIUZ
Processing species THHD
Processing species JHCN
Processing species PDIE
Processing species PMRP
Processing species DGNP
Processing species SFZX
Processing species AQGE
Processing species KYAD
Processing species RBYC
Processing species XVJB
Processing species EDHN
Processing species EILE
Processing species WVEF
Processing species ZHEE
Processing species IANR
Processing species QNOC
Processing species DHAW
Processing species NCVK
Processing species TJQY
Processing species VCIN
Processing species BLVL
BLVL does not have a peptide database
Processing species EAVM
Processing species QIEH
Processing species SXCE
Processing species ZPKK
Processing species SQCF
Processing species XFFT
Processing species CQMG
Processing species ACFP
Processing species WKCY
Processing species WWKL
WWKL does not have a peptide database
Processing species HYZL
Processing species DZTK
Processing species IPWB
Processing species VMNH
Processing species CSUV
Processing species TZWR
Processing species HABV
Processing species UVQL
Processing species BXBF
Processing species GTSV
Processing species LAPO
Processing species LJQF
Processing species QSKP
Processing species HELY
HELY does not have a peptide database
Processing species EZXQ
Processing species ZLOA
ZLOA does not have a peptide database
Processing species MBQU
Processing species UPZX
Processing species UAXP
Processing species JOIS
Processing species CRNC
Processing species CZPV
Processing species SWPE
Processing species RTTY
Processing species MYZV
Processing species KPTE
Processing species PKMO
Processing species OLXF
Processing species WYIG
Processing species ZSAB
Processing species ATFX
Processing species WMUK
Processing species QJXB
Processing species PUDI
Processing species AWJM
Processing species YUOM
Processing species WAXR
Processing species JSZD
Processing species FCCA
Processing species BCAA
Processing species UVDC
Processing species CAIX
Processing species VCCF
Processing species OBTI
Processing species UHJR
Processing species PGKL
Processing species HBHB
Processing species VFFP
Processing species IKFD
Processing species QICX
Processing species BFJL
Processing species XONJ
Processing species VUSY
Processing species UZNH
Processing species QURC
Processing species ZETY
Processing species BTZX
Processing species OTAN
Processing species VTLJ
VTLJ does not have a peptide database
Processing species QAUE
Processing species JEXA
Processing species YZGX
Processing species ADHK
Processing species UFHF
Processing species KVFU
Processing species WXVX
Processing species AVJK
Processing species PPPZ
Processing species SERM
Processing species LRTN
Processing species YSRZ
Processing species DTOA
Processing species BNTL
Processing species DAAD
Processing species ODDO
Processing species NGRR
Processing species WVMY
Processing species FNEN
Processing species OJCW
Processing species HUSX
Processing species WRPP
WRPP does not have a peptide database
Processing species BEFC
Processing species OXYP
Processing species AXBO
Processing species JPDJ
JPDJ does not have a peptide database
Processing species PTFA
Processing species VJSJ
Processing species NJJO
Processing species JWEY
Processing species EIGQ
Processing species RGMN
RGMN does not have a peptide database
Processing species OUER
Processing species XKVX
Processing species IPPG
Processing species ABEH
Processing species NIGS
Processing species MZOB
Processing species IDGE
Processing species DIHD
Processing species IWJG
Processing species CSWE
Processing species EMAL
Processing species DKFZ
Processing species YQIJ
YQIJ does not have a peptide database
Processing species SMUR
Processing species HANM
Processing species QZZU
Processing species SZUO
Processing species GIPR
Processing species PVGM
Processing species MGVU
Processing species UOYN
Processing species JCLQ
Processing species UFQC
Processing species QEHE
Processing species YADI
Processing species DSUV
Processing species EDEQ
Processing species JGYZ
Processing species HGSM
Processing species KPUM
Processing species ECTD
Processing species GGJD
Processing species BQEQ
BQEQ does not have a peptide database
Processing species JOPH
Processing species ULGV
Processing species WQRD
Processing species PCNH
Processing species DNQA
Processing species NBMW
Processing species WEAC
Processing species AYIY
Processing species PCGJ
Processing species UTQR
Processing species TKEK
Processing species SVQC
Processing species QKEI
Processing species GDZS
Processing species DCCI
Processing species DTNC
Processing species RWKR
Processing species FDMM
Processing species EQDA
Processing species PUCW
Processing species ATYL
Processing species SNNC
Processing species DYFF
Processing species FYUH
Processing species BAHE
Processing species DMLT
Processing species IYDF
Processing species LRRR
Processing species GETL
Processing species WHNV
Processing species FUMQ
Processing species UCNM
Processing species EAAA
Processing species TAGM
Processing species PHCE
Processing species RTNA
Processing species XMBA
Processing species GNPX
GNPX does not have a peptide database
Processing species HRUR
Processing species MXFG
Processing species JCMU
Processing species TORX
Processing species KTAR
Processing species MZLD
Processing species UEEN
UEEN does not have a peptide database
Processing species FAMO
Processing species WUZV
Processing species ZVFS
ZVFS does not have a peptide database
Processing species PHOQ
Processing species VTOK
Processing species XMOG
Processing species URZI
Processing species UMUL
Processing species ZRIN
Processing species OWAS
Processing species GNRI
Processing species DCVZ
Processing species YKZB
Processing species PTBJ
PTBJ does not have a peptide database
Processing species TPUT
Processing species EBOL
EBOL does not have a peptide database
Processing species YRHD
YRHD does not have a peptide database
Processing species CLRW
CLRW does not have a peptide database
Processing species EDXZ
Processing species GAKQ
Processing species CWLL
Processing species SIBR
Processing species XXYA
Processing species EJBY
Processing species XRLM
Processing species GRFT
Processing species COBX
Processing species PSHB
Processing species GCFE
Processing species MQIV
Processing species CPOC
Processing species VXKB
Processing species SDXI
Processing species QSLH
Processing species NHAG
Processing species ERWT
Processing species ALUC
Processing species EMBR
Processing species NAUM
Processing species OQBM
Processing species IZNU
Processing species AHRN
Processing species KTWL
Processing species BOLZ
Processing species DLJZ
DLJZ does not have a peptide database
Processing species GHLP
Processing species LQJY
Processing species LWCK
Processing species OSMU
Processing species UGJI
Processing species JNVS
Processing species DLAI
Processing species NMDZ
Processing species MKZR
Processing species AIOU
Processing species CLMX
Processing species CLNU
Processing species TPEM
Processing species TQKZ
Processing species CWYJ
Processing species EITK
Processing species JBYE
Processing species EDBB
Processing species OINM
Processing species MVSE
Processing species QIKZ
QIKZ does not have a peptide database
Processing species WEQK
Processing species AJFN
Processing species SBZH
Processing species NTEO
Processing species SALZ
Processing species DFYF
Processing species ASMV
Processing species SXML
Processing species QACK
Processing species GIOY
Processing species WSYE
Processing species NUSE
Processing species UBLN
Processing species AFQQ
Processing species DUQG
DUQG does not have a peptide database
Processing species OAGK
Processing species TEZA
Processing species EYKJ
Processing species DUNJ
Processing species DESP
Processing species XRCX
Processing species UQAZ
Processing species EXHX
Processing species ZNZC
Processing species QBGG
Processing species LMXP
Processing species IPUI
Processing species DSWR
Processing species KJBH
Processing species QXWF
Processing species NVSO
Processing species GFVW
Processing species RZSW
Processing species JZHZ
Processing species HXDV
Processing species UYED
Processing species HRVY
Processing species RLCS
Processing species HXCD
Processing species DDRL
Processing species BMSE
Processing species FUPX
FUPX does not have a peptide database
Processing species KGJF
Processing species KFZY
Processing species ZGDS
Processing species MMJI
Processing species JNKW
Processing species GUMF
Processing species DOVJ
Processing species CFRN
Processing species IZLO
Processing species IHPC
Processing species HUQC
Processing species IXVJ
Processing species AUIP
Processing species FXGI
Processing species HLJG
Processing species SNBI
Processing species QRNU
Processing species CAQZ
Processing species GSZA
Processing species JTRM
Processing species FFFY
Processing species MTII
Processing species DWZT
Processing species MFIN
Processing species COCP
Processing species BYQM
Processing species OCWZ
Processing species VVVV
Processing species DGXS
Processing species VBHQ
VBHQ does not have a peptide database
Processing species SILJ
Processing species QOXT
Processing species NHIX
Processing species OVRB
Processing species SFCT
Processing species GDKK
Processing species THEW
Processing species AFLV
Processing species OOSO
Processing species MWYQ
Processing species PRFO
Processing species KXSK
Processing species YBML
Processing species ICNN
Processing species PLBZ
Processing species CMCY
Processing species GJPF
Processing species KBXS
Processing species LDME
Processing species XEUV
Processing species IQYY
Processing species DMIN
Processing species JDTY
Processing species ZKPF
Processing species DPFW
Processing species FGRF
Processing species XFJG
Processing species RCUX
Processing species UZXL
Processing species JVBR
Processing species EMJJ
Processing species FCEL
Processing species BLAJ
Processing species JHUL
Processing species KOFB
Processing species SVTS
Processing species YJUG
Processing species LTZF
Processing species MUMD
Processing species VTUS
Processing species MTHW
Processing species THDM
Processing species XZME
Processing species CNTZ
Processing species JSAG
Processing species LELS
Processing species MVRF
Processing species HOKG
Processing species LSJW
Processing species ONBE
Processing species RQZP
Processing species TCYS
Processing species KYNE
Processing species RDYY
Processing species IXEM
Processing species WTDE
Processing species SART
Processing species QGLJ
Processing species NSPR
Processing species HXJE
Processing species HWUP
Processing species YMES
Processing species TZNS
Processing species KNKV
Processing species TNWF
Processing species LSKK
Processing species JNUB
Processing species UOEL
Processing species JQCX
Processing species OYLU
Processing species BDJQ
Processing species BYPY
Processing species PWSG
Processing species XPAF
XPAF does not have a peptide database
Processing species WBIB
Processing species WXNT
Processing species CIEA
Processing species RMVB
Processing species IADP
Processing species YPIC
Processing species YXNR
Processing species SOHV
Processing species ROEI
Processing species ZENX
Processing species VQYB
VQYB does not have a peptide database
Processing species ZMGN
Processing species BPKH
Processing species BXAY
Processing species NNOK
Processing species XUAB
Processing species WCOR
Processing species XBKS
Processing species HATH
Processing species RCAH
Processing species TIJL
Processing species OMXG
Processing species CXSJ
Processing species PZAP
Processing species YLWW
Processing species BSTR
Processing species PPQR
Processing species BRUD
Processing species JBND
Processing species MFTM

------------------------------------------------------------
Sender: LSF System <lsfadmin@c07b03>
Subject: Job 1133241: <search> in cluster <umghpcc> Exited

Job <search> was submitted from host <ghpcc06> by user <jm33a> in cluster <umghpcc> at Thu Jan 16 15:42:57 2020.
Job was executed on host(s) <17*c07b03>, in queue <long>, as user <jm33a> in cluster <umghpcc> at Thu Jan 16 15:47:22 2020.
</home/jm33a> was used as the home directory.
</home/jm33a/domain_evolution/1KT_searches> was used as the working directory.
Started at Thu Jan 16 15:47:22 2020.
Terminated at Thu Jan 16 16:47:07 2020.
Results reported at Thu Jan 16 16:47:07 2020.

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/bash

#BSUB -W 48:00             	# How much time does your job need (HH:MM)
#BSUB -R rusage[mem=500]	# How much memory
#BSUB -R span[hosts=1]		# Keep on one CPU cluster
#BSUB -n 17                	# Where X is in the set {1..X}
#BSUB -J search     	# Job Name
#BSUB -o out.%J           	# Append to output log file
#BSUB -e err.%J           	# Append to error log file
#BSUB -q long            	# Which queue to use {short, long, parallel, GPU, interactive}

module load MAFFT/7.313
module load hmmer/3.1b2
module load blast/2.2.22
module load noisy/1.5.12
module load iqtree/1.6.3


echo "building database to find priors..."
    cat $(ls ~/supertree/databases/primary_transcript_databases/*.oneline.fa) > combined_onelines.fa
    database=combined_onelines.fa
echo "collecting prior sequences from database..."
    grep -w -A 1 -f clade_input_IDs.txt --no-group-separator $database | awk '{print $1}' > input_seqs.fa #collect sequences of inputs
echo "Aligning prior sequences..."
    mafft input_seqs.fa > input_alignment.fasta #align sequences
echo "building an HMM from the alignment..."
    hmmbuild -o hmmout.txt model.hmm input_alignment.fasta #build HMM of clade


echo "collect the top 2 hits for each of the species listed in flowering_plants_species_IDs"
while read species_ID
do
    echo "Processing species $species_ID"
    directory=$(find /project/uma_madelaine_bartlett/JarrettMan/sequence_databases/1KP_seqs/seqs -name "*$species_ID*" -type d) #find directory of the species
    protein_database_path=$directory/*.prots.out #this is now the path to species' protein database
   
    test -f $protein_database_path #test if file exists. Write 0 to $? if yes, 1 if no
    if [ $? -eq 0 ] #only perform the search when a database exists, otherwise report the error
    then
        hmmsearch -o hmmout.txt --noali --tblout table.output.txt model.hmm $protein_database_path #scan all sequences from a species with the HMM model
    
        #next collec the sequence of the top n hits found in the search
        for hit_number in {4..5} #top hit is on line 4, specify how many lines after that
        do
            hit=$(sed -n "${hit_number}p" < table.output.txt | awk '{print $1}') #gene ID from hit number line
            hit_full_ID=">${species_ID}_${hit}" #concatenate the species ID and the geneID with an underscore between, using fasta format >
            echo $hit_full_ID >> top_hits.seqs.fa #add gene full gene ID to fasta sequences
            grep -w -A 1 $hit $protein_database_path | tail -n 1 >> top_hits.seqs.fa #add gene's sequence to running list
        done
    else

(... more ...)
------------------------------------------------------------

Exited with exit code 2.

Resource usage summary:

    CPU time :                                   18892.56 sec.
    Max Memory :                                 517 MB
    Average Memory :                             267.40 MB
    Total Requested Memory :                     8500.00 MB
    Delta Memory :                               7983.00 MB
    Max Swap :                                   -
    Max Processes :                              4
    Max Threads :                                69
    Run time :                                   3585 sec.
    Turnaround time :                            3850 sec.

The output (if any) is above this job summary.



PS:

Read file <err.1133241> for stderr output of this job.

